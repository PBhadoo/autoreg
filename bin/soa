#!/bin/sh
# $Id$

AZ=/usr/local/dns-manager/bin/access-zone
ZONES=/usr/local/dns-manager/zones
DEST=/etc/namedb/
NDC=/usr/sbin/ndc

cd $ZONES

if [ "$USER" = "" ]; then
	echo '$USER not set'
	exit 1
fi

if [ "$*" = "" ]; then
	echo "usage: $0 zonelist"
	exit 1
fi

for i in $*
do
	if $AZ -u$USER -asoa $i; then
		echo $i updated
		diff -U2 $DEST/$i $i
		mv -f $DEST/$i $DEST/$i.old
		cp $i $DEST
		echo ----
		mod=1
	fi
done

if [ "$mod" = "1" ]; then
	echo "now:"
	echo "$NDC reload"
else
	echo no change.
fi
